import telebot
from telebot import types
import re


bot = telebot.TeleBot('7608703327:AAGJLSJClBu67vEThRMOpzCW6QCGteWKPf8')

# –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
mm = types.ReplyKeyboardMarkup(row_width=2, resize_keyboard=True)
button1 = types.KeyboardButton("–£–∑–Ω–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —ç–ª–µ–º–µ–Ω—Ç–µ")
button2 = types.KeyboardButton("–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è –º–∞—Å—Å–∞")
button3 = types.KeyboardButton("–ê—Ç–æ–º–Ω–∞—è –¥–æ–ª—è")
button4 = types.KeyboardButton("–í–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å")
button5 = types.KeyboardButton("–ê—Ç–æ–º–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞")
button6 = types.KeyboardButton("–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è")
button7 = types.KeyboardButton("–°—Ç–µ–ø–µ–Ω—å –æ–∫–∏—Å–ª–µ–Ω–∏—è")

mm.add(button1, button2, button3, button4, button5, button6, button7)

# –•–∏–º–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
elements = {
    'H': {'Name_el': '–í–æ–¥–æ—Ä–æ–¥', 'Numb_el': 1, 'Massa_el': 1, 'metal': False},
    'He': {'Name_el': '–ì–µ–ª–∏–π', 'Numb_el': 2, 'Massa_el': 4, 'metal': False},
    'Li': {'Name_el': '–õ–∏—Ç–∏–π', 'Numb_el': 3, 'Massa_el': 7, 'metal': True},
    'Be': {'Name_el': '–ë–µ—Ä–∏–ª–ª–∏–π', 'Numb_el': 4, 'Massa_el': 9, 'metal': True},
    'B': {'Name_el': '–ë–æ—Ä', 'Numb_el': 5, 'Massa_el': 11, 'metal': False},
    'C': {'Name_el': '–£–≥–ª–µ—Ä–æ–¥', 'Numb_el': 6, 'Massa_el': 12, 'metal': False},
    'N': {'Name_el': '–ê–∑–æ—Ç', 'Numb_el': 7, 'Massa_el': 14, 'metal': False},
    'O': {'Name_el': '–ö–∏—Å–ª–æ—Ä–æ–¥', 'Numb_el': 8, 'Massa_el': 16, 'metal': False},
    'F': {'Name_el': '–§—Ç–æ—Ä', 'Numb_el': 9, 'Massa_el': 19, 'metal': False},
    'Ne': {'Name_el': '–ù–µ–æ–Ω', 'Numb_el': 10, 'Massa_el': 20, 'metal': False},
    'Na': {'Name_el': '–ù–∞—Ç—Ä–∏–π', 'Numb_el': 11, 'Massa_el': 23, 'metal': True},
    'Mg': {'Name_el': '–ú–∞–≥–Ω–∏–π', 'Numb_el': 12, 'Massa_el': 24, 'metal': True},
    'Al': {'Name_el': '–ê–ª—é–º–∏–Ω–∏–π', 'Numb_el': 13, 'Massa_el': 27, 'metal': True},
    'Si': {'Name_el': '–ö—Ä–µ–º–Ω–∏–π', 'Numb_el': 14, 'Massa_el': 28, 'metal': False},
    'P': {'Name_el': '–§–æ—Å—Ñ–æ—Ä', 'Numb_el': 15, 'Massa_el': 31, 'metal': False},
    'S': {'Name_el': '–°–µ—Ä–∞', 'Numb_el': 16, 'Massa_el': 32, 'metal': False},
    'Cl': {'Name_el': '–•–ª–æ—Ä', 'Numb_el': 17, 'Massa_el': 35.5, 'metal': False},
    'Ar': {'Name_el': '–ê—Ä–≥–æ–Ω', 'Numb_el': 18, 'Massa_el': 40, 'metal': False},
    'K': {'Name_el': '–ö–∞–ª–∏–π', 'Numb_el': 19, 'Massa_el': 39, 'metal': True},
    'Ca': {'Name_el': '–ö–∞–ª—å—Ü–∏–π', 'Numb_el': 20, 'Massa_el': 40, 'metal': True},
    'Sc': {'Name_el': '–°–∫–∞–Ω–¥–∏–π', 'Numb_el': 21, 'Massa_el': 45, 'metal': True},
    'Ti': {'Name_el': '–¢–∏—Ç–∞–Ω', 'Numb_el': 22, 'Massa_el': 48, 'metal': True},
    'V': {'Name_el': '–í–∞–Ω–∞–¥–∏–π', 'Numb_el': 23, 'Massa_el': 51, 'metal': True},
    'Cr': {'Name_el': '–•—Ä–æ–º', 'Numb_el': 24, 'Massa_el': 52, 'metal': True},
    'Mn': {'Name_el': '–ú–∞—Ä–≥–∞–Ω–µ—Ü', 'Numb_el': 25, 'Massa_el': 55, 'metal': True},
    'Fe': {'Name_el': '–ñ–µ–ª–µ–∑–æ', 'Numb_el': 26, 'Massa_el': 56, 'metal': True},
    'Co': {'Name_el': '–ö–æ–±–∞–ª—å—Ç', 'Numb_el': 27, 'Massa_el': 59, 'metal': True},
    'Ni': {'Name_el': '–ù–∏–∫–µ–ª—å', 'Numb_el': 28, 'Massa_el': 59, 'metal': True},
    'Cu': {'Name_el': '–ú–µ–¥—å', 'Numb_el': 29, 'Massa_el': 64, 'metal': True},
    'Zn': {'Name_el': '–¶–∏–Ω–∫', 'Numb_el': 30, 'Massa_el': 65, 'metal': True},
    'Ga': {'Name_el': '–ì–∞–ª–ª–∏–π', 'Numb_el': 31, 'Massa_el': 70, 'metal': True},
    'Ge': {'Name_el': '–ì–µ—Ä–º–∞–Ω–∏–π', 'Numb_el': 32, 'Massa_el': 73, 'metal': False},
    'As': {'Name_el': '–ú—ã—à—å—è–∫', 'Numb_el': 33, 'Massa_el': 75, 'metal': False},
    'Se': {'Name_el': '–°–µ–ª–µ–Ω', 'Numb_el': 34, 'Massa_el': 79, 'metal': False},
    'Br': {'Name_el': '–ë—Ä–æ–º', 'Numb_el': 35, 'Massa_el': 80, 'metal': False},
    'Kr': {'Name_el': '–ö—Ä–∏–ø—Ç–æ–Ω', 'Numb_el': 36, 'Massa_el': 84, 'metal': False},
    'Rb': {'Name_el': '–†—É–±–∏–¥–∏–π', 'Numb_el': 37, 'Massa_el': 85, 'metal': True},
    'Sr': {'Name_el': '–°—Ç—Ä–æ–Ω—Ü–∏–π', 'Numb_el': 38, 'Massa_el': 88, 'metal': True},
    'Y': {'Name_el': '–ò—Ç—Ç—Ä–∏–π', 'Numb_el': 39, 'Massa_el': 89, 'metal': True},
    'Zr': {'Name_el': '–¶–∏—Ä–∫–æ–Ω–∏–π', 'Numb_el': 40, 'Massa_el': 91, 'metal': True},
    'Nb': {'Name_el': '–ù–∏–æ–±–∏–π', 'Numb_el': 41, 'Massa_el': 93, 'metal': True},
    'Mo': {'Name_el': '–ú–æ–ª–∏–±–¥–µ–Ω', 'Numb_el': 42, 'Massa_el': 96, 'metal': True},
    'Tc': {'Name_el': '–¢–µ—Ö–Ω–µ—Ü–∏–π', 'Numb_el': 43, 'Massa_el': 98, 'metal': True},
    'Ru': {'Name_el': '–†—É—Ç–µ–Ω–∏–π', 'Numb_el': 44, 'Massa_el': 101, 'metal': True},
    'Rh': {'Name_el': '–†–æ–¥–∏–π', 'Numb_el': 45, 'Massa_el': 103, 'metal': True},
    'Pd': {'Name_el': '–ü–∞–ª–ª–∞–¥–∏–π', 'Numb_el': 46, 'Massa_el': 106, 'metal': True},
    'Ag': {'Name_el': '–°–µ—Ä–µ–±—Ä–æ', 'Numb_el': 47, 'Massa_el': 108, 'metal': True},
    'Cd': {'Name_el': '–ö–∞–¥–º–∏–π', 'Numb_el': 48, 'Massa_el': 112, 'metal': True},
    'In': {'Name_el': '–ò–Ω–¥–∏–π', 'Numb_el': 49, 'Massa_el': 115, 'metal': True},
    'Sn': {'Name_el': '–û–ª–æ–≤–æ', 'Numb_el': 50, 'Massa_el': 119, 'metal': True},
    'Sb': {'Name_el': '–°—É—Ä—å–º–∞', 'Numb_el': 51, 'Massa_el': 122, 'metal': False},
    'Te': {'Name_el': '–¢–µ–ª–ª—É—Ä', 'Numb_el': 52, 'Massa_el': 128, 'metal': False},
    'I': {'Name_el': '–ô–æ–¥', 'Numb_el': 53, 'Massa_el': 127, 'metal': False},
    'Xe': {'Name_el': '–ö—Å–µ–Ω–æ–Ω', 'Numb_el': 54, 'Massa_el': 131, 'metal': False},
    'Cs': {'Name_el': '–¶–µ–∑–∏–π', 'Numb_el': 55, 'Massa_el': 133, 'metal': True},
    'Ba': {'Name_el': '–ë–∞—Ä–∏–π', 'Numb_el': 56, 'Massa_el': 137, 'metal': True},
    'La': {'Name_el': '–õ–∞–Ω—Ç–∞–Ω', 'Numb_el': 57, 'Massa_el': 139, 'metal': True},
    'Ce': {'Name_el': '–¶–µ—Ä–∏–π', 'Numb_el': 58, 'Massa_el': 140, 'metal': True},
    'Pr': {'Name_el': '–ü—Ä–∞–∑–µ–æ–¥–∏–º', 'Numb_el': 59, 'Massa_el': 141, 'metal': True},
    'Nd': {'Name_el': '–ù–µ–æ–¥–∏–º', 'Numb_el': 60, 'Massa_el': 144, 'metal': True},
    'Pm': {'Name_el': '–ü—Ä–æ–º–µ—Ç–∏–π', 'Numb_el': 61, 'Massa_el': 145, 'metal': True},
    'Sm': {'Name_el': '–°–∞–º–∞—Ä–∏–π', 'Numb_el': 62, 'Massa_el': 150, 'metal': True},
    'Eu': {'Name_el': '–ï–≤—Ä–æ–ø–∏–π', 'Numb_el': 63, 'Massa_el': 152, 'metal': True},
    'Gd': {'Name_el': '–ì–∞–¥–æ–ª–∏–Ω–∏–π', 'Numb_el': 64, 'Massa_el': 157, 'metal': True},
    'Tb': {'Name_el': '–¢–µ—Ä–±–∏–π', 'Numb_el': 65, 'Massa_el': 159, 'metal': True},
    'Dy': {'Name_el': '–î–∏—Å–ø—Ä–æ–∑–∏–π', 'Numb_el': 66, 'Massa_el': 163, 'metal': True},
    'Ho': {'Name_el': '–ì–æ–ª—å–º–∏–π', 'Numb_el': 67, 'Massa_el': 165, 'metal': True},
    'Er': {'Name_el': '–≠—Ä–±–∏–π', 'Numb_el': 68, 'Massa_el': 167, 'metal': True},
    'Tm': {'Name_el': '–¢—É–ª–∏–π', 'Numb_el': 69, 'Massa_el': 169, 'metal': True},
    'Yb': {'Name_el': '–ò—Ç—Ç–µ—Ä–±–∏–π', 'Numb_el': 70, 'Massa_el': 173, 'metal': True},
    'Lu': {'Name_el': '–õ—é—Ç–µ—Ü–∏–π', 'Numb_el': 71, 'Massa_el': 175, 'metal': True},
    'Hf': {'Name_el': '–ì–∞—Ñ–Ω–∏–π', 'Numb_el': 72, 'Massa_el': 178, 'metal': True},
    'Ta': {'Name_el': '–¢–∞–Ω—Ç–∞–ª', 'Numb_el': 73, 'Massa_el': 181, 'metal': True},
    'W': {'Name_el': '–í–æ–ª—å—Ñ—Ä–∞–º', 'Numb_el': 74, 'Massa_el': 184, 'metal': True},
    'Re': {'Name_el': '–†–µ–Ω–∏–π', 'Numb_el': 75, 'Massa_el': 186, 'metal': True},
    'Os': {'Name_el': '–û—Å–º–∏–π', 'Numb_el': 76, 'Massa_el': 190, 'metal': True},
    'Ir': {'Name_el': '–ò—Ä–∏–¥–∏–π', 'Numb_el': 77, 'Massa_el': 192, 'metal': True},
    'Pt': {'Name_el': '–ü–ª–∞—Ç–∏–Ω–∞', 'Numb_el': 78, 'Massa_el': 195, 'metal': True},
    'Au': {'Name_el': '–ó–æ–ª–æ—Ç–æ', 'Numb_el': 79, 'Massa_el': 197, 'metal': True},
    'Hg': {'Name_el': '–†—Ç—É—Ç—å', 'Numb_el': 80, 'Massa_el': 201, 'metal': True},
    'Tl': {'Name_el': '–¢–∞–ª–ª–∏–π', 'Numb_el': 81, 'Massa_el': 204, 'metal': True},
    'Pb': {'Name_el': '–°–≤–∏–Ω–µ—Ü', 'Numb_el': 82, 'Massa_el': 207, 'metal': True},
    'Bi': {'Name_el': '–í–∏—Å–º—É—Ç', 'Numb_el': 83, 'Massa_el': 209, 'metal': True},
    'Po': {'Name_el': '–ü–æ–ª–æ–Ω–∏–π', 'Numb_el': 84, 'Massa_el': 209, 'metal': False},
    'At': {'Name_el': '–ê—Å—Ç–∞—Ç', 'Numb_el': 85, 'Massa_el': 210, 'metal': False},
    'Rn': {'Name_el': '–†–∞–¥–æ–Ω', 'Numb_el': 86, 'Massa_el': 222, 'metal': False},
    'Fr': {'Name_el': '–§—Ä–∞–Ω—Ü–∏–π', 'Numb_el': 87, 'Massa_el': 223, 'metal': True},
    'Ra': {'Name_el': '–†–∞–¥–∏–π', 'Numb_el': 88, 'Massa_el': 226, 'metal': True},
    'Ac': {'Name_el': '–ê–∫—Ç–∏–Ω–∏–π', 'Numb_el': 89, 'Massa_el': 227, 'metal': True},
    'Th': {'Name_el': '–¢–æ—Ä–∏–π', 'Numb_el': 90, 'Massa_el': 232, 'metal': True},
    'Pa': {'Name_el': '–ü—Ä–æ—Ç–∞–∫—Ç–∏–Ω–∏–π', 'Numb_el': 91, 'Massa_el': 231, 'metal': True},
    'U': {'Name_el': '–£—Ä–∞–Ω', 'Numb_el': 92, 'Massa_el': 238, 'metal': True},
    'Np': {'Name_el': '–ù–µ–ø—Ç—É–Ω–∏–π', 'Numb_el': 93, 'Massa_el': 237, 'metal': True},
    'Pu': {'Name_el': '–ü–ª—É—Ç–æ–Ω–∏–π', 'Numb_el': 94, 'Massa_el': 244, 'metal': True},
    'Am': {'Name_el': '–ê–º–µ—Ä–∏—Ü–∏–π', 'Numb_el': 95, 'Massa_el': 243, 'metal': True},
    'Cm': {'Name_el': '–ö—é—Ä–∏–π', 'Numb_el': 96, 'Massa_el': 247, 'metal': True},
    'Bk': {'Name_el': '–ë–µ—Ä–∫–ª–∏–π', 'Numb_el': 97, 'Massa_el': 247, 'metal': True},
    'Cf': {'Name_el': '–ö–∞–ª–∏—Ñ–æ—Ä–Ω–∏–π', 'Numb_el': 98, 'Massa_el': 251, 'metal': True},
    'Es': {'Name_el': '–≠–π–Ω—à—Ç–µ–π–Ω–∏–π', 'Numb_el': 99, 'Massa_el': 252, 'metal': True},
    'Fm': {'Name_el': '–§–µ—Ä–º–∏–π', 'Numb_el': 100, 'Massa_el': 257, 'metal': True},
    'Md': {'Name_el': '–ú–µ–Ω–¥–µ–ª–µ–≤–∏–π', 'Numb_el': 101, 'Massa_el': 258, 'metal': True},
    'No': {'Name_el': '–ù–æ–±–µ–ª–∏–π', 'Numb_el': 102, 'Massa_el': 259, 'metal': True},
    'Lr': {'Name_el': '–õ–æ—É—Ä–µ–Ω—Å–∏–π', 'Numb_el': 103, 'Massa_el': 262, 'metal': True},
    'Rf': {'Name_el': '–†–µ–∑–µ—Ä—Ñ–æ—Ä–¥–∏–π', 'Numb_el': 104, 'Massa_el': 267, 'metal': True},
    'Db': {'Name_el': '–î—É–±–Ω–∏–π', 'Numb_el': 105, 'Massa_el': 270, 'metal': True},
    'Sg': {'Name_el': '–°–∏–±–æ—Ä–≥–∏–π', 'Numb_el': 106, 'Massa_el': 271, 'metal': True},
    'Bh': {'Name_el': '–ë–æ—Ä–∏–π', 'Numb_el': 107, 'Massa_el': 270, 'metal': True},
    'Hs': {'Name_el': '–•–∞—Å—Å–∏–π', 'Numb_el': 108, 'Massa_el': 277, 'metal': True},
    'Mt': {'Name_el': '–ú–µ–π—Ç–Ω–µ—Ä–∏–π', 'Numb_el': 109, 'Massa_el': 276, 'metal': True},
    'Ds': {'Name_el': '–î–∞—Ä–º—à—Ç–∞–¥—Ç–∏–π', 'Numb_el': 110, 'Massa_el': 281, 'metal': True}}

Valentnost = {'1' : ['H', 'I', 'Li', 'Na', 'K'], '2':['Be', 'Mg', 'Ca', 'Sr', 'Ba', 'Ra', 'Zn', 'O'], '3':['B', 'Al']}
constant_dergree = {'1' : ['Fr', 'Cs', 'Rb', 'Li', 'Na', 'K'], '2':['Be', 'Mg', 'Ca', 'Sr', 'Ba', 'Ra', 'Zn', 'O'], '3':['B', 'Al'], '-1': ['F']}


el_config = {
    'H': '1s1',
    'He': '1s2',
    'Li': '1s2 2s1',
    'Be': '1s2 2s2',
    'B': '1s2 2s2 2p1',
    'C': '1s2 2s2 2p2',
    'N': '1s2 2s2 2p3',
    'O': '1s2 2s2 2p4',
    'F': '1s2 2s2 2p5',
    'Ne': '1s2 2s2 2p6',
    'Na': '1s2 2s2 2p6 3s1',
    'Mg': '1s2 2s2 2p6 3s2',
    'Al': '1s2 2s2 2p6 3s2 3p1',
    'Si': '1s2 2s2 2p6 3s2 3p2',
    'P': '1s2 2s2 2p6 3s2 3p3',
    'S': '1s2 2s2 2p6 3s2 3p4',
    'Cl': '1s2 2s2 2p6 3s2 3p5',
    'Ar': '1s2 2s2 2p6 3s2 3p6',
    'K': '1s2 2s2 2p6 3s2 3p6 4s1',
    'Ca': '1s2 2s2 2p6 3s2 3p6 4s2',
    'Cm': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f8',
    'Bk': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f9',
    'Cf': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f10',
    'Es': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f11',
    'Fm': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f12',
    'Md': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f13',
    'No': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f14',
    'Lr': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f14 6d1',
    'Rf': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f14 6d2',
    'Db': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f14 6d3',
    'Sg': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f14 6d4',
    'Bh': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f14 6d5',
    'Hs': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f14 6d6',
    'Mt': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f14 6d7',
    'Ds': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f14 6d8',
    'Rg': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f14 6d9',
    'Cn': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f14 6d10',
    'Nh': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f14 6d11',
    'Fl': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f14 6d12',
    'Mc': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f14 6d13',
    'Lv': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f14 6d14',
    'Ts': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f14 6d15',
    'Og': '1s2 2s2 2p6 3s2 3p6 4s2 3d10 4p6 5s2 4f14 5d10 6p6 7s2 5f14 6d16'
}
element_symbols = [
    'H', 'He', 'Li', 'Be', 'B', 'C', 'N', 'O', 'F', 'Ne',
    'Na', 'Mg', 'Al', 'Si', 'P', 'S', 'Cl', 'Ar', 'K', 'Ca',
    'Sc', 'Ti', 'V', 'Cr', 'Mn', 'Fe', 'Co', 'Ni', 'Cu', 'Zn',
    'Ga', 'Ge', 'As', 'Se', 'Br', 'Kr', 'Rb', 'Sr', 'Y', 'Zr',
    'Nb', 'Mo', 'Tc', 'Ru', 'Rh', 'Pd', 'Ag', 'Cd', 'In', 'Sn',
    'Sb', 'Te', 'I', 'Xe', 'Cs', 'Ba', 'La', 'Ce', 'Pr', 'Nd',
    'Pm', 'Sm', 'Eu', 'Gd', 'Tb', 'Dy', 'Ho', 'Er', 'Tm', 'Yb',
    'Lu', 'Hf', 'Ta', 'W', 'Re', 'Os', 'Ir', 'Pt', 'Au', 'Hg',
    'Tl', 'Pb', 'Bi', 'Po', 'At', 'Rn', 'Fr', 'Ra', 'Ac', 'Th',
    'Pa', 'U', 'Np', 'Pu', 'Am', 'Cm', 'Bk', 'Cf', 'Es', 'Fm',
    'Md', 'No', 'Lr', 'Rf', 'Db', 'Sg', 'Bh', 'Hs', 'Mt', 'Ds',
    'Rg', 'Cn', 'Nh', 'Fl', 'Mc', 'Lv', 'Ts', 'Og'
]

# –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤
def parse_formula(formula):
    elements_list = []
    index = 0
    while index < len(formula):
        matched_symbol = ''
        for symbol in element_symbols:
            if formula[index:].startswith(symbol):
                if len(symbol) > len(matched_symbol):
                    matched_symbol = symbol
        if matched_symbol:
            element = matched_symbol
            index += len(matched_symbol)
            count = ''
            while index < len(formula) and formula[index].isdigit():
                count += formula[index]
                index += 1
            count = int(count) if count else 1
            elements_list.append({
                'element': element,
                'index': count,
            })
        else:
            index += 1
    return elements_list

def count_molecular_mass(form):
    molecular_m = 0.0
    formula = parse_formula(form)
    for i in formula:
        el = i['element']
        molecular_m += elements[el]['Massa_el'] * i['index']
    return molecular_m

def molecular_mass(form):
    mass = count_molecular_mass(form)
    return f'–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è –º–∞—Å—Å–∞ {form} = {mass} –∞.–µ.–º.'



def atomic_fraction(formula):
    parsed = parse_formula(formula)
    total_mass = count_molecular_mass(formula)
    result = []
    for elem in parsed:
        element = elem['element']
        count = elem['index']
        mass = elements[element]['Massa_el'] * count
        fraction = (mass / total_mass) * 100
        result.append(f'–ê—Ç–æ–º–Ω–∞—è –¥–æ–ª—è {element}: {round(fraction, 2)}%')
    return '\n'.join(result)

def get_inform(el):
    try:
        el_num = int(el)
        el_symbol = element_symbols[el_num - 1]
    except ValueError:
        el_symbol = el.strip().capitalize()
    except IndexError:
        return "–≠–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω"
    
    if el_symbol not in elements:
        return "–≠–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω"
    
    data = elements[el_symbol]
    metal = '–º–µ—Ç–∞–ª–ª' if data['metal'] else '–Ω–µ–º–µ—Ç–∞–ª–ª'
    return (
        f"–≠–ª–µ–º–µ–Ω—Ç: {el_symbol}\n"
        f"–ù–∞–∑–≤–∞–Ω–∏–µ: {data['Name_el']}\n"
        f"–ê—Ç–æ–º–Ω—ã–π –Ω–æ–º–µ—Ä: {data['Numb_el']}\n"
        f"–ê—Ç–æ–º–Ω–∞—è –º–∞—Å—Å–∞: {data['Massa_el']}\n"
        f"–¢–∏–ø: {metal}"
    )


def valentnost(formula):
    form = parse_formula(formula)
    if form[0]['element'] in Valentnost['1'] or form[0]['element'] in Valentnost['2'] or form[0]['element'] in Valentnost['3']:
        if form[0]['element'] in Valentnost['1']:
            v_p = 1
            val = form[0]['index']//form[1]['index']
        if form[0]['element'] in Valentnost['2']:
            val = (form[0]['index']*2)//form[1]['index']
            v_p = 2
        if form[0]['element'] in Valentnost['3']:
            v_p = 3
            val = (form[0]['index']*3)//form[1]['index']
            
        return f"–í–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å {form[0]['element']} - {v_p}. –í–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å {form[1]['element']} - {val}"
    
    if form[1]['element'] in Valentnost['1'] or form[1]['element'] in Valentnost['2'] or form[1]['element'] in Valentnost['3']:
        if form[1]['element'] in Valentnost['1']:
            v_p = 1
            val = form[1]['index']//form[0]['index']
        if form[1]['element'] in Valentnost['2']:
            val = (form[1]['index']*2)//form[0]['index']
            v_p = 2
        if form[1]['element'] in Valentnost['3']:
            v_p = 3
            val = (form[1]['index']*3)//form[0]['index']
        return f"–í–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å {form[1]['element']} - {v_p}. –í–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å {form[0]['element']} - {val}"
        
def degree_of_oxidation(form):
    form = parse_formula(form)
    if len(form) ==1 :
        return f"–°—Ç–µ–ø–µ–Ω—å –æ–∫–∏—Å–ª–µ–Ω–∏—è {form[0]['element']} = 0"
    elif len(form) == 2:
        if form[0]['element'] in constant_dergree['1'] or form[0]['element'] in constant_dergree['2'] or form[0]['element'] in constant_dergree['3']:
            if form[0]['element'] in constant_dergree['1']:
                d_o = 1
                d_o_2 = (0-form[0]['index'])//form[1]['index']
            if form[0]['element'] in constant_dergree['2']:
                d_o_2 = (0 - form[0]['index']*2)//form[1]['index']
                d_o = 2
            if form[0]['element'] in constant_dergree['3']:
                d_o = 3
                d_o_2 = (0 - form[0]['index']*3)//form[1]['index']
            if form[0]['element'] in constant_dergree['-1']:
                d_o = -1
                d_o_2 = (0 - form[0]['index']*-1)//form[1]['index']
            if form[0]['element'] == 'H' and form[1]['element']['matal'] == True:
                d_o = -1
                d_o_2 = (0 - form[0]['index']*-1)//form[1]['index']
                
            if form[0]['element'] == 'H' and form[1]['element']['matal'] == False:
                d_o = 1
                d_o_2 = (0 - form[0]['index'])//form[1]['index']
            
            return f"–°—Ç–µ–ø–µ–Ω—å –æ–∫–∏—Å–ª–µ–Ω–∏—è {form[0]['element']} = {d_o}. –°—Ç–µ–ø–µ–Ω—å –æ–∫–∏—Å–ª–µ–Ω–∏—è {form[1]['element']} = {d_o_2}"

    
        if form[1]['element'] in constant_dergree['1'] or form[1]['element'] in constant_dergree['2'] or form[1]['element'] in constant_dergree['3']:
            if form[1]['element'] in constant_dergree['1']:
                d_o = 1
                d_o_2 = (0-form[1]['index'])//form[0]['index']
            if form[1]['element'] in constant_dergree['2']:
                d_o = (0 - form[1]['index']*2)//form[0]['index']
                d_o_2 = 2
            if form[1]['element'] in constant_dergree['3']:
                d_o = 3
                d_o_2 = (0 - form[1]['index']*3)//form[0]['index']
            if form[1]['element'] in constant_dergree['-1']:
                d_o = -1
                d_o_2 = (0 - form[1]['index']*-1)//form[0]['index']

            if form[1]['element'] == 'H' and form[0]['element']['matal'] == True:
                d_o = -1
                d_o_2 = (0 - form[1]['index']*-1)//form[0]['index']
                
            if form[1]['element'] == 'H' and form[0]['element']['matal'] == False:
                d_o = 1
                d_o_2 = (0 - form[1]['index'])//form[0]['index']
            
            return f"–°—Ç–µ–ø–µ–Ω—å –æ–∫–∏—Å–ª–µ–Ω–∏—è {form[0]['element']} = {d_o}_2. –°—Ç–µ–ø–µ–Ω—å –æ–∫–∏—Å–ª–µ–Ω–∏—è {form[1]['element']} = {d_o}"
    else:
        return '–ü–æ–∫–∞ —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ —É–º–µ–µ—Ç –≤—ã—Å—á–∏—Ç—ã–≤–∞—Ç—å –±–æ–ª—å—à–µ –¥–≤—É—Ö –µ–ª–µ–º–µ–Ω—Ç–æ–≤' 
        
def atomic_structure(formula):
    parsed = parse_formula(formula)
    protons = sum(elements[e['element']]['Numb_el'] * e['index'] for e in parsed)
    electrons = protons  # –î–ª—è –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –∞—Ç–æ–º–∞
    neutrons = sum((elements[e['element']]['Massa_el'] - elements[e['element']]['Numb_el']) * e['index'] for e in parsed)
    return (
        f"–ü—Ä–æ—Ç–æ–Ω—ã: {protons}\n"
        f"–≠–ª–µ–∫—Ç—Ä–æ–Ω—ã: {electrons}\n"
        f"–ù–µ–π—Ç—Ä–æ–Ω—ã: {neutrons}"
    )

def electronic_configur(element):
    return el_config.get(element.capitalize(), "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
@bot.message_handler(commands=['start'])
def start_message(message):
    bot.send_message(message.chat.id, "–ü—Ä–∏–≤–µ—Ç ‚úåÔ∏è –Ø chemistry_bot –∏ —è –º–æ–≥—É –ø–æ–º–æ—á—å —Ç–µ–±–µ —Å —Ö–∏–º–∏–µ–π. –î–ª—è —ç—Ç–æ–≥–æ –≤—ã–±–µ—Ä–∏ –∫–Ω–æ–ø–∫—É —Å —Ç–æ–π —Ç–µ–º–æ–π, –∫–æ—Ç–æ—Ä–∞—è —Ç–µ–±—è –∏–Ω—Ç–µ—Ä–∏—Å—É–µ—Ç, –∞ –ø–æ—Ç–æ–º –≤–≤–µ–¥–∏ —Ñ–æ—Ä–º—É–ª—É. –£–¥–∞—á–∏!üçÄ", reply_markup=mm)

@bot.message_handler(func=lambda message: True)
def handle_buttons(message):
    try:
        if message.text == "–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è –º–∞—Å—Å–∞":
            msg = bot.send_message(message.chat.id, "–í–≤–µ–¥–∏—Ç–µ —Ö–∏–º–∏—á–µ—Å–∫—É—é —Ñ–æ—Ä–º—É–ª—É (–ù–∞–ø—Ä–∏–º–µ—Ä: H2O):")
            bot.register_next_step_handler(msg, process_molecular_mass)
            
        elif message.text == "–ê—Ç–æ–º–Ω–∞—è –¥–æ–ª—è":
            msg = bot.send_message(message.chat.id, "–í–≤–µ–¥–∏—Ç–µ —Ö–∏–º–∏—á–µ—Å–∫—É—é —Ñ–æ—Ä–º—É–ª—É (–ù–∞–ø—Ä–∏–º–µ—Ä: H20):")
            bot.register_next_step_handler(msg, process_atomic_fraction)
            
        elif message.text == "–£–∑–Ω–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —ç–ª–µ–º–µ–Ω—Ç–µ":
            msg = bot.send_message(message.chat.id, "–í–≤–µ–¥–∏—Ç–µ —Å–∏–º–≤–æ–ª –∏–ª–∏ –Ω–æ–º–µ—Ä —ç–ª–µ–º–µ–Ω—Ç–∞ (–ù–∞–ø—Ä–∏–º–µ—Ä: Cl):")
            bot.register_next_step_handler(msg, process_element_info)
            
        elif message.text == "–í–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å":
            msg = bot.send_message(message.chat.id, "–í–≤–µ–¥–∏—Ç–µ —Ñ–æ—Ä–º—É–ª—É –∏–∑ –¥–≤—É—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–ù–∞–ø—Ä–∏–º–µ—Ä: Mn2O7):")
            bot.register_next_step_handler(msg, process_valence)
            
        elif message.text == "–ê—Ç–æ–º–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞":
            msg = bot.send_message(message.chat.id, "–í–≤–µ–¥–∏—Ç–µ —Ñ–æ—Ä–º—É–ª—É (–ù–∞–ø—Ä–∏–º–µ—Ä: F2):")
            bot.register_next_step_handler(msg, process_atomic_structure)
            
        elif message.text == "–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è":
            msg = bot.send_message(message.chat.id, "–í–≤–µ–¥–∏—Ç–µ —Å–∏–º–≤–æ–ª —ç–ª–µ–º–µ–Ω—Ç–∞(–ù–∞–ø—Ä–∏–º–µ—Ä: Cl):")
            bot.register_next_step_handler(msg, process_electron_config)

        elif message.text == "–°—Ç–µ–ø–µ–Ω—å –æ–∫–∏—Å–ª–µ–Ω–∏—è":
            msg = bot.send_message(message.chat.id, "–í–≤–µ–¥–∏—Ç–µ —Ñ–æ—Ä–º—É–ª—É (–ù–∞–ø—Ä–∏–º–µ—Ä: CaH2):")
            bot.register_next_step_handler(msg, process_degree_of_oxidation)
            
    except Exception as e:
        bot.send_message(message.chat.id, f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ :(")

def process_molecular_mass(message):
    try:
        result = molecular_mass(message.text)
        bot.send_message(message.chat.id, result)
    except Exception as e:
        bot.send_message(message.chat.id, f"–û—à–∏–±–∫–∞: {str(e)}")
        
        
def process_atomic_fraction(message):
    try:
        result = atomic_fraction(message.text)
        bot.send_message(message.chat.id, result)
    except Exception as e:
        bot.send_message(message.chat.id, f"–û—à–∏–±–∫–∞: {str(e)}")

def process_element_info(message):
    try:
        result = get_inform(message.text)
        bot.send_message(message.chat.id, result)
    except Exception as e:
        bot.send_message(message.chat.id, f"–û—à–∏–±–∫–∞: {str(e)}")

def process_valence(message):
    try:
        result = valentnost(message.text)
        bot.send_message(message.chat.id, result)
    except Exception as e:
        bot.send_message(message.chat.id, f"–û—à–∏–±–∫–∞: {str(e)}")

def process_atomic_structure(message):
    try:
        result = atomic_structure(message.text)
        bot.send_message(message.chat.id, result)
    except Exception as e:
        bot.send_message(message.chat.id, f"–û—à–∏–±–∫–∞: {str(e)}")

def process_degree_of_oxidation(message):
    try:
        result = degree_of_oxidation(message.text)
        bot.send_message(message.chat.id, result)
    except Exception as e:
        bot.send_message(message.chat.id, f"–û—à–∏–±–∫–∞: {str(e)}")


def process_electron_config(message):
    try:
        result = electronic_configur(message.text)
        bot.send_message(message.chat.id, result)
    except Exception as e:
        bot.send_message(message.chat.id, f"–û—à–∏–±–∫–∞: {str(e)}")

bot.polling(none_stop=True, interval=0)

